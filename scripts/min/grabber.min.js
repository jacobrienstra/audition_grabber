chrome.storage.sync.get(function(t){try{var e=t.sections,n=document.getElementsByTagName("strong"),o=[],a={},r=null,i="",l=n[0],s=l.textContent.trim()+" ";s+=nextUntil(l,"strong","br").map(t=>t.textContent.trim()).join(" ");for(const[t,l]of[...n].entries()){let s=l.textContent.trim();switch(l.previousSibling&&3===l.previousSibling.nodeType&&l.nextSibling&&3===l.nextSibling.nodeType&&(s=l.previousSibling.textContent.trim()+l.textContent.trim()+l.nextSibling.textContent.trim()),s){case"AUDITION DATE":case"AUDITION DATES":lines=nextUntil(l,"strong","BR");let c="";for(let[t,e]of[...lines].entries())if(e=e.textContent.trim(),moment(e,"ddd, MMM D, YYYY").isValid())o.length>0&&(o[o.length-1].extraText+=c,c=""),curDate=e,/\*+/.test(e)&&(excIn=o.length);else if(timeRegex.test(e)&&""!==curDate){let t=e.match(timeRegex),[n,a]=t[1].split("-").map(t=>t.trim()),r="";null!=t[2]&&(r=t[2].replace(/[()]/g,"")),null!=t[3]&&(c+=t[3].trim()),void 0===a&&(a=n),r=null!=tzAbbrs[r]?tzAbbrs[r]:"",o.push({start:[curDate,n].join(" "),end:[curDate,a].join(" "),tz:r,extraText:""})}else""!=c&&(c+="\n\n"),c+=e,t===lines.length-1&&(o[o.length-1].extraText+=c);o=o.map(function(t){idesc="";let e=moment.tz(t.start,"ddd, MMM D, YYYY h:mma",t.tz),n=moment.tz(t.end,"ddd, MMM D, YYYY h:mma",t.tz);return n.format()==e.format()&&(n.add(1,"hours"),idesc+="***NO END TIME PROVIDED. FIGURE IT OUT I GUESS.***\n\n"),{start:e,end:n,idesc:idesc+t.extraText}});break;case"LOCATION":case"LOCATIONS":const g=nextUntil(l,"strong","br");for(let[t,e]of[...g].entries())if(shortDateRegex.test(e.textContent.trim())){r=g.slice(0,t).join(" ");let n=getShortDate(e.textContent.trim());null!=n&&(a[n]=nextUntil(e,"br","br",2).map(t=>t.textContent.trim()).join(" "))}for(var d=t,m=l;d++&&(m=n[d])&&d<n.length&&shortDateRegex.test(m.textContent.trim());)locDate=getShortDate(m.textContent.trim()),a[locDate]=nextUntil(m,"strong","br").map(t=>t.textContent.trim()).join(" "),null===r&&(r=g.map(t=>t.textContent.trim()).join(" "));break;default:if(!e.includes(s))break;""!=i&&(i+="\n\n"),i+=s+"\n"+nextUntil(l,"strong","br").map(t=>t.textContent.trim()).join(" ")}}var c=window.location.href;for(date of o){var g=date.start.format("DDD");date.loc=g in a?a[g]:r}if("apple"==t.calendar){if(0===o.length)throw"No events found on this page ¯\\_(ツ)_/¯";var x=ics();for(date of o)x.addEvent(s,(date.idesc+"\n\n"+i).replace(/\n/g,"\\n"),escapeCommas(date.loc),date.start,date.end,c);var f=camelize(s.replace(/[^a-z\s]/gi,"")).slice(0,20)+moment().valueOf();x.download(f)}if("google"==t.calendar){var u=[];for(date of o){var p="https://calendar.google.com/calendar/r/eventedit?trp=False&sf=true&text="+encodeURIComponent(s)+"&ctz="+date.start.tz()+"&dates="+date.start.utc().format("YYYYMMDD[T]HHmmss[Z]")+"/"+date.end.utc().format("YYYYMMDD[T]HHmmss[Z]")+"&details="+encodeURIComponent(date.idesc+"\n\n"+i+"\n\n"+c)+"&location="+encodeURI(date.loc);u.push(p)}for(link of u)window.open(link,"_blank")}}catch(t){console.log(t),launchToast(t)}});